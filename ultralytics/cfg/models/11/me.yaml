# Ultralytics ğŸš€ AGPL-3.0 License - https://ultralytics.com/license

# Ultralytics RT-DETR-ResNet50 hybrid object detection model with P3/8 - P5/32 outputs
# Model docs: https://docs.ultralytics.com/models/rtdetr
# Task docs: https://docs.ultralytics.com/tasks/detect

# Parameters
nc: 80 # number of classes
scales: # model compound scaling constants, i.e. 'model=yolov8n-cls.yaml' will call yolov8-cls.yaml with scale 'n'
  # [depth, width, max_channels]
  l: [1.00, 1.00, 1024]

# ä¿®æ”¹backboneï¼Œå¢åŠ æ›´å¤šæµ…å±‚ç‰¹å¾
backbone:
  - [-1, 1, ResNetLayer, [3, 64, 1, True, 1]] # 0
  - [-1, 1, ResNetLayer, [64, 64, 1, False, 3]] # 1
  - [-1, 1, ResNetLayer, [256, 128, 2, False, 4]] # 2
  - [-1, 1, ResNetLayer, [512, 256, 2, False, 6]] # 3
  - [-1, 1, ResNetLayer, [1024, 512, 2, False, 3]] # 4

head:
  # å¢åŠ P2å±‚ (1/4å°ºåº¦)
  - [-1, 1, Conv, [256, 1, 1, None, 1, 1, False]] # 5
  - [-1, 1, AIFI, [1024, 8]]
  - [-1, 1, Conv, [256, 1, 1]] # 7

  # P5 -> P4
  - [-1, 1, nn.Upsample, [None, 2, "nearest"]]
  - [3, 1, Conv, [256, 1, 1, None, 1, 1, False]] # 9
  - [[-2, -1], 1, Concat, [1]]
  - [-1, 3, RepC3, [256]] # 11

  # P4 -> P3
  - [-1, 1, Conv, [256, 1, 1]] # 12
  - [-1, 1, nn.Upsample, [None, 2, "nearest"]]
  - [2, 1, Conv, [256, 1, 1, None, 1, 1, False]] # 14
  - [[-2, -1], 1, Concat, [1]]
  - [-1, 3, RepC3, [256]] # 16

  # P3 -> P2 (æ–°å¢å°ç›®æ ‡æ£€æµ‹å±‚)
  - [-1, 1, Conv, [256, 1, 1]] # 17
  - [-1, 1, nn.Upsample, [None, 2, "nearest"]]
  - [1, 1, Conv, [256, 1, 1, None, 1, 1, False]] # 19
  - [[-2, -1], 1, Concat, [1]]
  - [-1, 3, RepC3, [256]] # 21

  # ä¸‹é‡‡æ ·è·¯å¾„
  - [-1, 1, Conv, [256, 3, 2]] # 22
  - [[-1, 17], 1, Concat, [1]]
  - [-1, 3, RepC3, [256]] # 24

  - [-1, 1, Conv, [256, 3, 2]] # 25
  - [[-1, 12], 1, Concat, [1]]
  - [-1, 3, RepC3, [256]] # 27

  - [-1, 1, Conv, [256, 3, 2]] # 28
  - [[-1, 7], 1, Concat, [1]]
  - [-1, 3, RepC3, [256]] # 30

  # ä½¿ç”¨P2, P3, P4, P5å››ä¸ªç‰¹å¾å±‚
  - [[21, 24, 27, 30], 1, Detect, [nc]] # Detect(P2, P3, P4, P5)